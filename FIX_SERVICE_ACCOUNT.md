# 繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝域ｨｩ髯舌お繝ｩ繝ｼ縺ｮ隗｣豎ｺ譁ｹ豕・

## 繧ｨ繝ｩ繝ｼ縺ｮ蜴溷屏

縲後Γ繝ｼ繝ｫ繧｢繝峨Ξ繧ｹ縺ｨ繝峨Γ繧､繝ｳ縺ｯ縲∵怏蜉ｹ縺ｪ Google 繧｢繧ｫ繧ｦ繝ｳ繝・..縲阪→縺・≧繧ｨ繝ｩ繝ｼ縺ｯ縲∽ｻ･荳九・逅・罰縺ｧ逋ｺ逕溘＠縺ｾ縺呻ｼ・

1. **App Engine縺後∪縺蛻晄悄蛹悶＆繧後※縺・↑縺・*
   - App Engine繧貞・譛溷喧縺吶ｋ縺ｨ縲√ョ繝輔か繝ｫ繝医し繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医′閾ｪ蜍慕噪縺ｫ菴懈・縺輔ｌ縺ｾ縺・

2. **繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医・繝｡繝ｼ繝ｫ繧｢繝峨Ξ繧ｹ縺碁俣驕輔▲縺ｦ縺・ｋ**
   - 繝励Ο繧ｸ繧ｧ繧ｯ繝・D縺ｧ縺ｯ縺ｪ縺上√・繝ｭ繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧剃ｽｿ逕ｨ縺吶ｋ蠢・ｦ√′縺ゅｋ蝣ｴ蜷医′縺ゅｊ縺ｾ縺・

## 隗｣豎ｺ譁ｹ豕・

### 譁ｹ豕・: App Engine繧貞・縺ｫ蛻晄悄蛹悶☆繧具ｼ域耳螂ｨ・・

App Engine繧貞・譛溷喧縺吶ｋ縺ｨ縲∵ｭ｣縺励＞繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医′閾ｪ蜍慕噪縺ｫ菴懈・縺輔ｌ縺ｾ縺吶・

#### 繧ｹ繝・ャ繝・: App Engine繧貞・譛溷喧

1. 莉･荳九・URL縺ｫ繧｢繧ｯ繧ｻ繧ｹ・・
   ```
   https://console.cloud.google.com/appengine?project=singular-server-480006-s8
   ```

2. 縲後い繝励Μ繧ｱ繝ｼ繧ｷ繝ｧ繝ｳ繧剃ｽ懈・縲阪ｒ繧ｯ繝ｪ繝・け

3. 繝ｪ繝ｼ繧ｸ繝ｧ繝ｳ繧帝∈謚橸ｼ域耳螂ｨ: `asia-northeast1` 縺ｾ縺溘・ `asia-northeast2`・・

4. 縲御ｽ懈・縲阪ｒ繧ｯ繝ｪ繝・け

5. 蛻晄悄蛹悶↓縺ｯ謨ｰ蛻・°縺九ｊ縺ｾ縺・

#### 繧ｹ繝・ャ繝・: 繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医ｒ遒ｺ隱・

蛻晄悄蛹門ｾ後∽ｻ･荳九・繧ｳ繝槭Φ繝峨〒繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医ｒ遒ｺ隱搾ｼ・

```bash
gcloud iam service-accounts list --project=singular-server-480006-s8
```

縺ｾ縺溘・縲；oogle Cloud Console縺ｧ・・
1. 縲栗AM縺ｨ邂｡逅・坂・縲後し繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医阪↓繧｢繧ｯ繧ｻ繧ｹ
2. `*@appspot.gserviceaccount.com` 縺ｾ縺溘・ `*@project.gserviceaccount.com` 縺ｧ邨ゅｏ繧九い繧ｫ繧ｦ繝ｳ繝医ｒ謗｢縺・

#### 繧ｹ繝・ャ繝・: 豁｣縺励＞繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医↓讓ｩ髯舌ｒ莉倅ｸ・

Secret Manager縺ｧ縲∫｢ｺ隱阪＠縺溘し繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医↓讓ｩ髯舌ｒ莉倅ｸ弱＠縺ｾ縺吶・

### 譁ｹ豕・: 繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧剃ｽｿ逕ｨ縺吶ｋ

繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧堤｢ｺ隱阪＠縺ｦ縲√◎繧後ｒ菴ｿ逕ｨ縺励∪縺吶・

#### 繧ｹ繝・ャ繝・: 繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧堤｢ｺ隱・

Google Cloud Console縺ｧ・・
1. 繝励Ο繧ｸ繧ｧ繧ｯ繝磯∈謚槭ラ繝ｭ繝・・繝繧ｦ繝ｳ繧偵け繝ｪ繝・け
2. 繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧堤｢ｺ隱搾ｼ井ｾ・ `123456789012`・・

縺ｾ縺溘・縲√さ繝槭Φ繝峨Λ繧､繝ｳ縺ｧ・・
```bash
gcloud projects describe singular-server-480006-s8 --format="value(projectNumber)"
```

#### 繧ｹ繝・ャ繝・: 繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医・繝｡繝ｼ繝ｫ繧｢繝峨Ξ繧ｹ繧呈ｧ狗ｯ・

繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医・繝｡繝ｼ繝ｫ繧｢繝峨Ξ繧ｹ縺ｯ莉･荳九・蠖｢蠑上〒縺呻ｼ・
```
PROJECT_NUMBER@project.gserviceaccount.com
```

萓・ `123456789012@project.gserviceaccount.com`

#### 繧ｹ繝・ャ繝・: Secret Manager縺ｧ讓ｩ髯舌ｒ莉倅ｸ・

1. Secret Manager縺ｧ `gemini-api-key` 繧帝幕縺・
2. 縲梧ｨｩ髯舌阪ち繝悶ｒ繧ｯ繝ｪ繝・け
3. 縲後・繝ｪ繝ｳ繧ｷ繝代Ν繧定ｿｽ蜉縲阪ｒ繧ｯ繝ｪ繝・け
4. **譁ｰ縺励＞繝励Μ繝ｳ繧ｷ繝代Ν**: `PROJECT_NUMBER@project.gserviceaccount.com` 繧貞・蜉・
5. **繝ｭ繝ｼ繝ｫ**: 縲郡ecret Manager 繧ｷ繝ｼ繧ｯ繝ｬ繝・ヨ 繧｢繧ｯ繧ｻ繧ｵ繝ｼ縲阪ｒ驕ｸ謚・
6. 縲御ｿ晏ｭ倥阪ｒ繧ｯ繝ｪ繝・け

### 譁ｹ豕・: 繧ｳ繝槭Φ繝峨Λ繧､繝ｳ縺ｧ讓ｩ髯舌ｒ莉倅ｸ趣ｼ医・繝ｭ繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧剃ｽｿ逕ｨ・・

繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ縺悟・縺九▲縺ｦ縺・ｋ蝣ｴ蜷茨ｼ・

```bash
# 繝励Ο繧ｸ繧ｧ繧ｯ繝育分蜿ｷ繧貞叙蠕暦ｼ井ｾ・ 123456789012・・
PROJECT_NUMBER=$(gcloud projects describe singular-server-480006-s8 --format="value(projectNumber)")

# 讓ｩ髯舌ｒ莉倅ｸ・
gcloud secrets add-iam-policy-binding gemini-api-key \
    --member="serviceAccount:${PROJECT_NUMBER}@project.gserviceaccount.com" \
    --role="roles/secretmanager.secretAccessor" \
    --project=singular-server-480006-s8
```

## 遒ｺ隱肴婿豕・

### 繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医・荳隕ｧ繧堤｢ｺ隱・

Google Cloud Console縺ｧ・・
1. 縲栗AM縺ｨ邂｡逅・坂・縲後し繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医阪↓繧｢繧ｯ繧ｻ繧ｹ
2. 莉･荳九・蠖｢蠑上・繧｢繧ｫ繧ｦ繝ｳ繝医ｒ謗｢縺呻ｼ・
   - `PROJECT_NUMBER@project.gserviceaccount.com`
   - `PROJECT_ID@appspot.gserviceaccount.com`

### 讓ｩ髯舌′豁｣縺励￥莉倅ｸ弱＆繧後※縺・ｋ縺狗｢ｺ隱・

Secret Manager縺ｧ・・
1. `gemini-api-key` 繧帝幕縺・
2. 縲梧ｨｩ髯舌阪ち繝悶ｒ遒ｺ隱・
3. 繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医′陦ｨ遉ｺ縺輔ｌ縺ｦ縺・ｌ縺ｰOK 笨・

## 謗ｨ螂ｨ謇矩・

1. **縺ｾ縺哂pp Engine繧貞・譛溷喧**・域婿豕・・・
   - 縺薙ｌ縺ｫ繧医ｊ縲∵ｭ｣縺励＞繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医′閾ｪ蜍慕噪縺ｫ菴懈・縺輔ｌ縺ｾ縺・

2. **繧ｵ繝ｼ繝薙せ繧｢繧ｫ繧ｦ繝ｳ繝医ｒ遒ｺ隱・*

3. **Secret Manager縺ｧ讓ｩ髯舌ｒ莉倅ｸ・*

縺薙・鬆・ｺ上〒騾ｲ繧√ｋ縺ｨ縲√お繝ｩ繝ｼ繧貞屓驕ｿ縺ｧ縺阪∪縺吶・


